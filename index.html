<html>
<head>
<meta charset='UTF-8' />
<link rel="stylesheet" type="text/css" href="main2.css" />
<link href="https://fonts.googleapis.com/css?family=Raleway:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
<script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
<title>Giving Bias a Platform</title>
<!-- MADE FOR INFO 5100 BY:
JESSIE TAFT (jgt43)
JEVAN HUTSON (jah553)
OLIVIA WHERRY (odw2)
& TYLER ALICEA (tra37)-->
</head>
<script>
	// Displays slide number slideNo and hides the active slide from the DOM
	function slideShow(slideNo){
		d3.selectAll(".slide")
		.style("display", "none");
		d3.selectAll(".slideButton")
		.style("background-color", null)
		.style("color", null);
		var page = "#page" + slideNo;
		var slide = "#sl" + slideNo;
		d3.select(page)
		.style("display", "block");
		d3.select(slide)
		.style("background-color", "#70A9A1")
		.style("color", "white");
	}
</script>

<body>
	<div id="header">
		<h1>Giving Bias A Platform</h1>
		<h2>Designing Against Bias & Discrimination In User-to-User Platforms</h2>
	</div>
	<div id="subheader">
		<p>There are many different strategies that designers can use to mediate interactions between users of their platforms. Some of these design strategies can cause or stop harmful bias or discrimination. Select a button below to see an example of a strategy in use.</p>
	</div>
	<div id="navwrap">
		<div id="nav">
			<a href="#s1" id="sl1" class="slideButton" onclick="slideShow(1);"> Corporate Diversity</a>
			<a href="#s2" id="sl2" class="slideButton" onclick="slideShow(2);">Community Composition</a>
			<a href="#s3" id="sl3" class="slideButton" onclick="slideShow(3);">Policies & Messaging </a>
			<a href="#s4" id="sl4" class="slideButton" onclick="slideShow(4);">Prompting & Priming</a>
		</div>
		<div id="nav">
			<a href="#s5" id="sl5" class="slideButton" onclick="slideShow(5);">What Users Can Learn</a>
			<a href="#s6" id="sl6" class="slideButton" onclick="slideShow(6);">Reputation & Ratings</a>
			<a href="#s7" id="sl7" class="slideButton" onclick="slideShow(7);">Reporting & Sanctioning </a>
			<a href="#s8" id="sl8" class="slideButton" onclick="slideShow(8);">Measurement & Detection </a>
		</div>
	</div>
<div id="page-wrap">
	<div id="page1" class="slide" style="display: none;">
		<h1> Company-Level Diversity & Inclusion </h1>
		<h2>Diversity of Apple, Facebook, and Google's Technical Workforce</h2>
		<p>Apple, Facebook, and Google are leaders in the field of technology. They set company standards for the technical workforce. However, lack of internal workforce diversity might mean that these companies are less likely to consider implicit bias towards underrepresented groups when designing platforms.</p>

		<div id="diversebuttons">
			<a class="button" id="raceButton" onclick="showRace()" style="background-color: #70A9A1; color: white;">Ethnicity </a>
			<a class="button" id="genderButton" onclick="showGender()">Gender</a>
		</div>
		<svg id="diversity" width="960" height="500"></svg>
		<script>

		//with help from https://bl.ocks.org/mbostock/3887235
		function showGender(){
			d3.select("#race").attr("display", "none");
			d3.select("#gender").attr("display", "inline");
			d3.select("#raceButton")
			.style("background-color", null)
			.style("color", null);
			d3.select("#genderButton")
			.style("background-color", "#70A9A1")
			.style("color", "white");
		}

		function showRace(){
			d3.select("#gender").attr("display", "none");
			d3.select("#race").attr("display", "inline");
			d3.select("#genderButton")
			.style("background-color", null)
			.style("color", null);
			d3.select("#raceButton")
			.style("background-color", "#70A9A1")
			.style("color", "white");
		}

		var diversity = d3.select("#diversity"),
		    width = +diversity.attr("width"),
		    height = +diversity.attr("height"),
		    radius = Math.min(width, height) / 2;

		var races = ["White", "Asian", "Hispanic", "Black", "Mixed", "Other"];
		var racecolor = ["#A634A7", "#50E3C9", "#304FFD", "#EACE41", "#F8333C", "#E948EC" ];
		var color = d3.scaleOrdinal(racecolor);
		var genders = ["Male", "Female"];
		var gendercolors = ["#A634A7","#50E3C9"];
		var gendercolor = d3.scaleOrdinal(gendercolors);

		var pie = d3.pie()
		    .sort(null)
		    .value(function(d) { return d.Percentage; });

		var path = d3.arc()
		    .outerRadius(radius - 100)
		    .innerRadius(0);

		var label = d3.arc()
		    .outerRadius(radius-40)
		    .innerRadius(0);

		//overall svg for race pie charts
		var race = diversity.append("g").attr("id", "race");

		//make apple race pie chart
		var appleethnic = race.append("g").attr("transform", "translate(" + width / 6 + "," + height / 2 + ")");

		d3.csv("corporate/appleethnicdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = appleethnic.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return color(d.data.Race); });

		  arc.append("text")
		      .attr("transform", function(d) {
						return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});

		//make google race pie chart
		var googleethnic = race.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

		d3.csv("corporate/googleethnicdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = googleethnic.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return color(d.data.Race); });

		  arc.append("text")
		      .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});

		//make facebook race pie chart
		var facebookethnic = race.append("g").attr("transform", "translate(" + width / 1.2 + "," + height / 2 + ")");

		d3.csv("corporate/facebookethnicdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = facebookethnic.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return color(d.data.Race); });

		  arc.append("text")
		      .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});

		race.append("text")
		 .attrs({x:130, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Apple");
		race.append("text")
			.attrs({x:440, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Facebook");
		race.append("text")
			.attrs({x:760, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Google");

		for (var i=0; i<racecolor.length; i++){
			race.append("rect")
				.attrs({x: 50 + (i*150), y: 450, height: 30, width: 30, fill: racecolor[i]});
			race.append("text")
				.attrs({x: 85 + (i*150), y: 465, 'alignment-baseline': "middle"})
				.text(races[i]);
		}


		//make overall group for appending gender data
		var gender = diversity.append("g").attr("id", "gender").attr("display", "none");

		///Apple Gender data
		var applegender = gender.append("g").attr("transform", "translate(" + width / 6 + "," + height / 2 + ")");

		d3.csv("corporate/applegenderdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = applegender.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return gendercolor(d.data.Gender); });

		  arc.append("text")
		      .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});


		///Facebook Gender data
		var facebookgender = gender.append("g").attr("transform", "translate(" + width / 1.2 + "," + height / 2 + ")");

		d3.csv("corporate/facebookgenderdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = facebookgender.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return gendercolor(d.data.Gender); });

		  arc.append("text")
		      .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});


		////Google Gender data
		var googlegender = gender.append("g").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

		d3.csv("corporate/googlegenderdata.csv", function(d) {
		  d.Percentage = +d.Percentage;
		  return d;
		}, function(error, data) {
		  if (error) throw error;

		  var arc = googlegender.selectAll(".arc")
		    .data(pie(data))
		    .enter().append("g")
		      .attr("class", "arc");

		  arc.append("path")
		      .attr("d", path)
		      .attr("fill", function(d) { return gendercolor(d.data.Gender); });

		  arc.append("text")
		      .attr("transform", function(d) { return "translate(" + label.centroid(d) + ")"; })
		      .attr("dy", "0.35em")
		      .text(function(d) { return d.data.Percentage + "%"; });
		});

		gender.append("text")
		 .attrs({x:130, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Apple");
		gender.append("text")
			.attrs({x:440, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Facebook");
		gender.append("text")
			.attrs({x:760, y: 60, 'font-size': 20, fill: "black", 'alignment-baseline': "middle"})
			.text("Google");

		for (var i=0; i<gendercolors.length; i++){
			gender.append("rect")
				.attrs({x: 400 + (i*150), y: 450, height: 30, width: 30, fill: gendercolors[i]});
			gender.append("text")
				.attrs({x: 435 + (i*150), y: 465, 'alignment-baseline': "middle"})
				.text(genders[i]);
		}

		</script>

	</div> <!--END page1-->

	<div id="page2" class="slide" style="display: none">
		<h1> Community Composition </h1>
		<h2>The Case of Dating Apps</h2>
		<p>Platforms can have rules or expectations about what kind of people are expected or allowed to use their apps or sites. These online dating apps have explicit or implicit requirements of their users. While some apps might target people of specific religions, genders, or educational backgrounds, others use features like connections to social media sites to ensure that users are on their best behavior.</p>
		<svg id="community" height="600" width="1000"></svg>
		<script>
		var community = d3.select("#community");

		// category text
		community.append("text")
			.attr("x", 190)
			.attr("y", 45)
			.attr("fill", "black")
			.text("Dating Apps");

		community.append("text")
			.attr("x", 640)
			.attr("y", 45)
			.attr("fill", "black")
			.text("Community Requirements");

		function circleMouse(c, color){
			d3.selectAll("." + c).attrs({'stroke-width': 4, stroke: color});
		}
		function circleOut(c){
			d3.selectAll("." + c).attrs({'stroke-width': 3, stroke: "black"});
		}

		function appMouse(a){
			d3.selectAll("#" + a).attrs({'stroke-width':4});
		}
		function appOut(a){
			d3.selectAll("#" + a).attrs({'stroke-width':3});
		}

		//Community Circles
		community.append("circle")
			.attrs({id: "circle", r: 35, cx: 650, cy:100, fill: "#A634A7"})
			.on("mouseover", function(){ circleMouse("location", "#A634A7"); })
			.on("mouseout", function(){ circleOut("location"); });

		community.append("circle")
			.attrs({id: "circle", r: 35, cx: 650, cy:200, fill: "#50E3C9"})
			.on("mouseover", function(){ circleMouse("gender", "#50E3C9"); })
			.on("mouseout", function(){ circleOut("gender"); });

		community.append("circle")
			.attrs({id: "circle", r: 35, cx: 650, cy:300, fill: "#304FFD"})
			.on("mouseover", function(){ circleMouse("social", "#304FFD"); })
			.on("mouseout", function(){ circleOut("social"); });

		community.append("circle")
			.attrs({id: "circle", r: 35, cx: 650, cy:400, fill: "#EACE41"})
			.on("mouseover", function(){ circleMouse("religion", "#EACE41"); })
			.on("mouseout", function(){ circleOut("religion"); });

		community.append("circle")
			.attrs({id: "circle", r: 35, cx: 650, cy:500, fill: "#F8333C"})
			.on("mouseover", function(){ circleMouse("education", "#F8333C"); })
			.on("mouseout", function(){ circleOut("education"); });

		//images
		community.append("image")
					.attr("xlink:href", "vis2/bumble.png")
					.attr("x", 705)
					.attr("y", 205)
					.attr("transform","scale(.3)")
					.on("mouseover", function(){ appMouse("bumble"); })
					.on("mouseout", function(){ appOut("bumble"); });

		community.append("image")
					.attr("xlink:href", "vis2/jswipe.png")
					.attr("x", 705)
					.attr("y", 530)
					.attr("transform","scale(.3)")
					.on("mouseover", function(){ appMouse("jswipe"); })
					.on("mouseout", function(){ appOut("jswipe"); });

		community.append("image")
					.attr("xlink:href", "vis2/tinder.png")
					.attr("x", 705)
					.attr("y", 865)
					.attr("transform","scale(.3)")
					.on("mouseover", function(){ appMouse("tinder"); })
					.on("mouseout", function(){ appOut("tinder"); });

		community.append("image")
					.attr("xlink:href", "vis2/league.png")
					.attr("x", 2250)
					.attr("y", 3735)
					.attr("transform","scale(.1)")
					.on("mouseover", function(){ appMouse("league"); })
					.on("mouseout", function(){ appOut("league"); });

		community.append("image")
					.attr("xlink:href", "vis2/grindr.png")
					.attr("x", 705)
					.attr("y", 1565)
					.attr("transform","scale(.3)")
					.on("mouseover", function(){ appMouse("grindr"); })
					.on("mouseout", function(){ appOut("grindr"); });

		///Text for circles
		community.append("text")
			.attrs({x: 700, y: 105})
			.text("Location");
		community.append("text")
			.attrs({x: 700, y: 205})
			.text("Gender");
		community.append("text")
			.attrs({x: 700, y: 305})
			.text("Social Media Account");
		community.append("text")
			.attrs({x: 700, y: 405})
			.text("Religion");
		community.append("text")
			.attrs({x: 700, y: 505})
			.text("Education");

		community.append("text")
			.attrs({x: 700, y: 125, id: "explanation"})
			.text("Location sharing is required to use the app.");
		community.append("text")
			.attrs({x: 700, y: 225, id: "explanation"})
			.text("This app targets users of a specific gender.");
		community.append("text")
			.attrs({x: 700, y: 325, id: "explanation"})
			.text("A social media account is required.");
		community.append("text")
			.attrs({x: 700, y: 425, id: "explanation"})
			.text("Open to users from a specific religion.");
		community.append("text")
			.attrs({x: 700, y: 525, id: "explanation"})
			.text("Open to alumni of specific colleges.");


		//text for images
		community.append("text")
			.attrs({x: 190, y: 105, 'text-anchor': "end"})
			.text("Bumble");
		community.append("text")
			.attrs({x: 190, y: 205, 'text-anchor': "end"})
			.text("Jswipe");
		community.append("text")
			.attrs({x: 190, y: 305, 'text-anchor': "end"})
			.text("Tinder");
		community.append("text")
			.attrs({x: 190, y: 405, 'text-anchor': "end"})
			.text("The League");
		community.append("text")
			.attrs({x: 190, y: 505, 'text-anchor': "end"})
			.text("Grindr");

		community.append("text")
			.attrs({x: 190, y: 125, 'text-anchor': "end", id: "explanation"})
			.text("Women message first.");
		community.append("text")
			.attrs({x: 190, y: 225, 'text-anchor': "end", id: "explanation"})
			.text("Targeted at Jewish daters.");
		community.append("text")
			.attrs({x: 190, y: 325, 'text-anchor': "end", id: "explanation"})
			.text("The all-purpose app.");
		community.append("text")
			.attrs({x: 190, y: 425, 'text-anchor': "end", id: "explanation"})
			.text("For Ivy League alums.");
		community.append("text")
			.attrs({x: 190, y: 525, 'text-anchor': "end", id: "explanation"})
			.text("For men seeking men.");

		///lines connecting apps to community structure
		///Bumble
		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "bumble")
			.attr("class", "location")
			.attr("x1", 288)
			.attr("y1", 100)
			.attr("x2", 616)
			.attr("y2", 100);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "bumble")
			.attr("class", "social")
			.attr("x1", 288)
			.attr("y1", 100)
			.attr("x2", 616)
			.attr("y2", 300);

		///Jswipe
		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "jswipe")
			.attr("class", "location")
			.attr("x1", 269)
			.attr("y1", 200)
			.attr("x2", 616)
			.attr("y2", 100);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "jswipe")
			.attr("class", "social")
			.attr("x1", 269)
			.attr("y1", 200)
			.attr("x2", 616)
			.attr("y2", 300);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "jswipe")
			.attr("class", "religion")
			.attr("x1", 269)
			.attr("y1", 200)
			.attr("x2", 616)
			.attr("y2", 400);

		///tinder
		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "tinder")
			.attr("class", "location")
			.attr("x1", 288)
			.attr("y1", 300)
			.attr("x2", 616)
			.attr("y2", 100);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "tinder")
			.attr("class", "social")
			.attr("x1", 288)
			.attr("y1", 300)
			.attr("x2", 616)
			.attr("y2", 300);

		///the league
		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
				.attr("id", "league")
				.attr("class", "location")
				.attr("x1", 275)
				.attr("y1", 400)
				.attr("x2", 616)
				.attr("y2", 100);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "league")
			.attr("class", "social")
			.attr("x1", 275)
			.attr("y1", 400)
			.attr("x2", 616)
			.attr("y2", 300);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "league")
			.attr("class", "education")
			.attr("x1", 275)
			.attr("y1", 400)
			.attr("x2", 616)
			.attr("y2", 500);

		///grindr
		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "grindr")
			.attr("class", "gender")
			.attr("x1", 279)
			.attr("y1", 500)
			.attr("x2", 616)
			.attr("y2", 200);

		community.append("line")
			.attrs({stroke: "black", 'stroke-width':2})
			.attr("id", "grindr")
			.attr("class", "location")
			.attr("x1", 279)
			.attr("y1", 500)
			.attr("x2", 616)
			.attr("y2", 100);

		</script>

	</div> <!--END page2-->

	<div id="page3" class="slide" style="display: none">
	<h1> Community Policies and Messaging</h1>
	<h2> Sexual Health & Dating Apps: A Design Scorecard</h2>
	<p> Location-based, user-to-user dating platforms play a critical role in facilitating social,romantic, and intimate interaction. A number of popular dating and hook-up applications are working with public health and advocacy organizations to develop design strategies to promote HIV/STI testing and reduce the bias and stigma associated with HIV. Here we review and score 20 different dating/hook-up applications for profile elements/disclosures and in-app resources health resources.

	<table>
		<tr>
			<th>HIV Status</th>
			<th>Last Tested Date</th>
			<th>Safety Practices</th>
			<th>Resources</th>
		</tr>
		<tr>
			<td>Allows or encourages users to disclose their HIV Status</td>
			<td>Allows or encourages users to disclose the date of their last HIV/STI screening</td>
			<td>Allows or encourages to disclose their sexual safety practices, such as condoms or PrEP</td>
			<td>Provides in-app information and resources relating to sexual health </td>

	</table>

	<svg id='legend' height="60" width="600" ></svg>
	<div id='scores'></div>
	<script>

	d3.tsv('sex.tsv', function (error,data) {

	  function tabulate(data, columns) {
			var table = d3.select('#scores').append('table')
			var thead = table.append('thead')
			var	tbody = table.append('tbody');

			// append the header row
			thead.append('tr')
			  .selectAll('th')
			  .data(columns).enter()
			  .append('th')
			    .text(function (column) { return column; });

			// create a row for each object in the data
			var rows = tbody.selectAll('tr')
			  .data(data)
			  .enter()
			  .append('tr');

			var cells = rows.selectAll('td')
			  .data(function(row) {
			  	//delete row['smm'];
			  	return Object.values(row);
			  })
			  .enter()
			  .append('td')
			  .classed('green', function(v) { return v == '1'; })
			  .classed('red', function(v) { return v == '0'; })
			  .classed('gay', function(v) {return v == '2'})
			  .classed('straight', function(v) {return v =='3'})
			  .append('span')
			  .text(function(a) {
			  	return a;
			  });

			var gaylegend = d3.select("#legend").append("rect").attr("height", 55 ).attr("width", 27 ).style("fill", "#70A9A1" ).attr("transform", "translate(0,0)");
			var gaytext = d3.select("#legend").append("text").text("App for Sexual Minority Men").attr("transform", "translate(36,33)");
			var straightlegend = d3.select("#legend").append("rect").attr("height", 55 ).attr("width", 27 ).style("fill", "#3A506B" ).attr("transform", "translate(300,0)");
			var straighttext = d3.select("#legend").append("text").text("App for Broader Audience").attr("transform", "translate(336,33)");

		  return table;
		};
		// render the table
		tabulate(data, ["Platform", "HIV Status", "Last Tested Date", "Safety Practices", "Resources"]); });

	</script>
	</div> <!--END page3-->

	<div id="page4" class="slide" style="display: none">
		<h1> Prompting & Priming </h1>
		<p>Prompts and primes are used by designers to make sure people are on their best behavior when they're using a site. But it's easy to prime or prompt the wrong kind of behavior if you're not careful. Click on an app or site to see what its designers have done that might cause or stop bias.</p>
		<svg id="pp"></svg>
	<script>
		var height = 720;
		var width = 960;
		var prompt = d3.select("#pp").attrs({height: height, width: width});

		prompt.append("text").attrs({x: width/2, y: 40, fill: "black", 'font-size':30})
			.attr("text-anchor", "middle")
			.text("What kinds of prompts and primes can designers use?");

		prompt.append("text").attrs({x: width/2, y: 80, fill: "black", 'font-size':30})
			.attr("text-anchor", "middle")
			.text("Early warning")
		prompt.append("text").attrs({x: width/2, y: 100, fill: "black", 'font-size':15})
			.attr("text-anchor", "middle")
			.text("These prompts show up when a user opens an app.")

		prompt.append("text").attrs({x: width/2, y: height/2 + 270, fill: "black", 'font-size':30})
			.attr("text-anchor", "middle")
			.text("Just-in-time");
		prompt.append("text").attrs({x: width/2, y: height/2 + 290, fill: "black", 'font-size':15})
			.attr("text-anchor", "middle")
			.text("These prompts appear just before or after the user acts.");

		prompt.append("text").attrs({x: width/2-250, y: height/2, fill: "black", 'font-size':30})
			.attr("text-anchor", "end")
			.text("Subtle");
		prompt.append("text").attrs({x: width/2-250, y: height/2+20, fill: "black", 'font-size':15})
			.attr("text-anchor", "end")
			.text("These prompts aren't very noticeable.");

		prompt.append("text").attrs({x: width/2+250, y: height/2, fill: "black", 'font-size':30})
			.attr("text-anchor", "start")
			.text("Obvious");
		prompt.append("text").attrs({x: width/2+250, y: height/2+20, fill: "black", 'font-size':15})
			.attr("text-anchor", "start")
			.text("These prompts are easy to see.");

		prompt.append("line")
			.attrs({x1: width/2, y1:120, x2: width/2, y2: height-120, stroke: "black"});
		prompt.append("line")
			.attrs({x1: width/2-240, y1: height/2, x2: width/2+240, y2: height/2, stroke: "black"});

		function parseline(line){
			line.so = Number(line.so);
			line.ej = Number(line.ej);
			return line;
		}

		d3.csv("priming/priming.csv", parseline, function(error, data){

			var soScale = d3.scaleLinear().domain([-1,1]).range([width/2-110, width/2+110]);
			var ejScale = d3.scaleLinear().domain([-1,1]).range([height/2+110, height/2-110]);

			var squareX = d3.scaleLinear().domain([-1,1]).range([width/2-230, width/2]);
			var squareY = d3.scaleLinear().domain([-1,1]).range([height/2, height/2-230]);

		prompt.selectAll("rect").data(data).enter().append("rect")
			.attrs(function(d){
				return {x:squareX(d.so), y:squareY(d.ej), fill: d.color};
			})
			.attrs({height: 230, width: 230,  opacity: 0.5, id: "ppsquare"})
			.on("click", function(d){
				d3.selectAll("#ppGroup").remove();
				showImage(d.Filename, d.color, d.App);
			});

		prompt.selectAll("text#app").data(data).enter().append("text")
			.attrs(function(d){
				return {x:soScale(d.so), y:ejScale(d.ej)};
			})
			.attrs({fill:"black", 'font-size':35, 'text-anchor':"middle", 'alignment-baseline':"middle"})
			.text(function(d){ return d.App; })
			.on("click", function(d){
				d3.selectAll("#ppGroup").remove();
				showImage(d.Filename, d.color, d.App);
			});
		})

		var daddyhuntText = ["Gay dating app", "DaddyHunt asks", "users to agree to", "the DaddyHunt Code", "when they create or", "edit their profiles", "ensuring that values","of safety and respect", "are front and center", "for the community."];
		var taskrabbitText = ["Task and labor site", "TaskRabbit shows", "users seeking workers", "a list of tasks that", "sometimes show", "images of gendered", "stereotypes of jobs", "like Personal Assitant.", "This early, subtle", "prompt could harm", "workers who don't fit","into these gendered","categories."];
		var twitterText = ["Researchers studying harrassment on Twitter", "built a bot that finds instances of racist", "language and tweets at the user asking them", "to stop. They found that white 'users' with", "many followers were most effective at", "changing behavior in this after-the-fact", "intervention."];
		var nextdoorText = ["Neighborhood and community app Nextdoor", "forces users reporting suspicious behavior","to describe suspects using characteristics","besides race, a subtle intervention that","stops innocent people from being reported."];

		function showImage(filename, color, app){
			var g = prompt.append("g").attr("id", "ppGroup")
				.on("click", function(){
					d3.selectAll("#ppGroup").remove();
				});
			g.append("rect")
				.attrs({x:(width/2)-300, y:(height/2)-300, height: 600, width: 600, fill: color});

			if(app=="DaddyHunt"){
				g.append("image")
					.attr("xlink:href", "priming/" + filename)
					.attrs({id: "ppImg", x:(width/2)-290, y:(height/2)-290})
					.attr("height", 440);
				for (i=0; i<daddyhuntText.length; i++){
					g.append("text")
						.attr("x", 495)
						.attr("y", (i * 40) + 130)
						.attrs({fill: "white", 'font-size': 27})
						.text(daddyhuntText[i]);
				}
			}
			else if (app=="TaskRabbit") {
				g.append("image")
					.attr("xlink:href", "priming/" + filename)
					.attrs({id: "ppImg", x:(width/2)-290, y:(height/2)-290})
					.attr("height", 450);
				for (i=0; i<taskrabbitText.length; i++){
					g.append("text")
						.attr("x", 490)
						.attr("y", (i * 40) + 130)
						.attrs({fill: "black", 'font-size': 27})
						.text(taskrabbitText[i]);
				}
			}
			else if (app=="Twitter") {
				g.append("image")
					.attr("xlink:href", "priming/" + filename)
					.attrs({id: "ppImg", x:(width/2)-290, y:(height/2)-290})
					.attr("width", 580);
				for (i=0; i<twitterText.length; i++){
					g.append("text")
						.attr("x", 200)
						.attr("y", (i * 40) + 400)
						.attrs({fill: "white", 'font-size': 27})
						.text(twitterText[i]);
				}
			}
			else if (app=="Nextdoor") {
				g.append("image")
					.attr("xlink:href", "priming/" + filename)
					.attrs({id: "ppImg", x:(width/2)-290, y:(height/2)-290})
					.attr("width", 440);
				for (i=0; i<nextdoorText.length; i++){
					g.append("text")
						.attr("x", 200)
						.attr("y", (i * 40) + 485)
						.attrs({fill: "black", 'font-size': 27})
						.text(nextdoorText[i]);
				}
			}
			g.append("image")
				.attr("xlink:href", "priming/close.png")
				.attrs({x: 737, y: 73, width:30});
		}

	</script>
</div> <!--END page4-->


	<div id="page5" class="slide" style="display: none">
		<h1> What Users Learn About One Another </h1>
		<h2> The Visible Hand: Outcomes for black sellers are worse than white sellers in online marketplaces: </h2>
		<p>If you walked into a store to buy a brand-new Apple iPod, would you be less likely to buy it, or want to pay less for it, if it were presented by a salesperson who was black rather than white?<br/><br/>
		Transpose that shopping experience to Craigslist, and that sums up how the average American behaves, according to newly published research co-authored by University of Virginia professor Jennifer Doleac.<br/><br/>
		Results of the study showed that black sellers did worse than white sellers on a variety of metrics:</p>
		<div id="hands"></div>
		<script>

		var raceData;

		d3.tsv("race2.tsv", function (error, data) {
		  if (error) {console.log(error); }

		    data.forEach(function(d){

		      differentialdisplay = Math.round((1 - (d.black / d.white)) * 100);
		      differential = (1 - (d.black / d.white));

		      baseline = .45;

		      baselineredux = baseline - (baseline * differential);

		      var handPath = "M216.328,133.369c17.025,0,27.393,13.896,27.393,30.922l-0.057,151.286c0,4.267,3.457,7.716,7.727,7.716c4.263,0,7.72-3.45,7.72-7.716l-0.048-248.82c0-17.022,13.803-30.821,30.83-30.821c17.023,0,30.828,13.799,30.828,30.821l0.04,236.134c0,4.844,3.917,8.76,8.757,8.76c4.833,0,8.757-3.917,8.757-8.76l0.008-272.059c0-17.033,13.8-30.832,30.828-30.832c17.028,0,30.825,13.799,30.825,30.832l0.223,269.056c0,4.387,3.553,7.936,7.938,7.936c4.244,0,7.668-3.326,7.893-7.51c0.016,0.003,0.045-227.849,0.045-227.849c0-17.025,13.793-30.825,30.818-30.825s30.83,13.799,30.83,30.825l0.217,333.124c0,4.75,3.854,8.606,8.604,8.606s8.6-3.856,8.6-8.606l0.145-118.66c0.008-17.029,13.811-30.821,30.836-30.817c17.023,0,30.82,13.807,30.82,30.838l-0.078,205.47c-2.617,26.062-76.139,140.179-103.217,144.849v70.38c0,22.171-17.971,40.132-40.135,40.132H278.156c-22.167,0-40.139-17.961-40.139-40.132v-76.289c-43.353-32.479-47.14-172.27-47.14-175.051V161.983C190.877,144.959,202.018,133.369,216.328,133.369z";

		      rowcontainer = d3.select("#hands").append("div").attr("id", "rowcontainer");
		      handcontainer = rowcontainer.append("div").attr("id", "handcontainer");
		      textcontainer = rowcontainer.append("div").attr("id", "textcontainer");
		      whitehand = handcontainer.append("div")
		        .attr("id", "whitehand").append("svg")
		        .attr("height", 350)
		        .attr("width", 260)
		        .append("path")
		        .attr("d", handPath)
		        .attr("transform", function(){return "scale(" + baseline + ")"}).style("fill", "#FFDFC4");
		      blackhand = handcontainer.append("div").attr("id", "blackhand").append("svg").attr("height", 350).attr("width", 260).append("path").attr("d", handPath).attr("transform", function(){return "scale(" + baselineredux + ")"}).style("fill", "#5C3836");
		      textbox1 = textcontainer.append("div").attr("id", "textbox1").append("text").text( function(){return differentialdisplay + "%"});
		      textbox2 = textcontainer.append("div").attr("id", "textbox2").append("text").text( function(){return d.variable});

		    });
		});

		</script>

	</div> <!--END page5-->
	<div id="page6" class="slide" style="display: none">
		<h1> Reputation, Reliability & Ratings </h1>
		<div class="page-padding"></div>
		<div id="container7" style="height: 200;">
		  <div id="stars" style="text-align: center;">
		    <h2 style="display: inline;">Select a rating for your driver:</h1>
		  </div>
		  <div id="photos" style="margin-top: 30px; display: none; text-align: center">
		    <!-- Photo from http://bit.ly/2qtx3Bc -->
		    <img src="vis7/man.jpg" alt="A man with a beard" style="border: 1px solid black">
		    <!-- Photo from http://bit.ly/2pYGbu3 -->
		    <img src="vis7/woman.jpg" alt="A woman sitting" style="border: 1px solid black">
		    <!-- Photo from http://bit.ly/2pYyQdQ -->
		    <img src="vis7/woman2.jpg" alt="A woman sings" style="border: 1px solid black">
		    <!-- Photo from http://bit.ly/2rtpl7H -->
		    <img src="vis7/man2.jpg" alt="A man looks at the camera" style="border: 1px solid black">
				<!-- Photo from http://bit.ly/2pZ3wvo -->
			 <img src="vis7/woman3.jpg" alt="A woman looks at the camera" style="border: 1px solid black">
		  </div>
		</div>

		<script>
		var svg = d3.select("#stars").append("svg")
		.attr("height", 40)
		.attr("width", 250)

		// Add svg stars
		for(var i = 0; i < 5; i++){
		  svg.append("polygon")
		  .attr("id", "star" + i)
		  .attr("class", "star")
		  .attr("points", "100,10 40,198 190,78 10,78 160,198")
		  .attr("transform", "scale(.2) translate(" + 185 * i + ", 10)")
		  .style("fill", "grey")
		  .style("fill-rule", "nonzero");
		}

		var selected = 0;
		var stars;

		svg.selectAll(".star")
		.on("mouseover", function(){
		  if(selected == 0){
		    var id = this.id;
		    if(id == "star0"){
		      d3.select(this).style("fill", "#f7ec59");
		      stars = 1;
		    } else if(id == "star1"){
		      d3.select(this).style("fill", "#f7ec59");
		      d3.select("#star0").style("fill", "#f7ec59");
		      stars = 2;
		    } else if(id == "star2"){
		      d3.select(this).style("fill", "#f7ec59");
		      d3.select("#star0").style("fill", "#f7ec59");
		      d3.select("#star1").style("fill", "#f7ec59");
		      stars = 3;
		    } else if(id == "star3"){
		      d3.select(this).style("fill", "#f7ec59");
		      d3.select("#star0").style("fill", "#f7ec59");
		      d3.select("#star1").style("fill", "#f7ec59");
		      d3.select("#star2").style("fill", "#f7ec59");
		      stars = 4;
		    } else if(id == "star4"){
		      d3.select(this).style("fill", "#f7ec59");
		      d3.select("#star0").style("fill", "#f7ec59");
		      d3.select("#star1").style("fill", "#f7ec59");
		      d3.select("#star2").style("fill", "#f7ec59");
		      d3.select("#star3").style("fill", "#f7ec59");
		      stars = 5;
		    }
		  }
		})
		.on("mouseout", function(){
		  if(selected == 0) {
		    d3.selectAll(".star").style("fill", "grey");
		  }
		})
		.on("click", function() {
			if(selected == 0){
				selected = 1;
			  d3.select("#photos").style("display", "block");
			  d3.select("#container7").style("height", "450px");
			  if(stars == 5) {
			    d3.select("#photos").append("text")
			    .html("<p>Thanks for your rating! Your rating of 5 stars went through for the first driver, the white male. Unfortunately, the act of evaluation itself can operate as a conduit for bias, meaning underrepresented groups could have lower ratings. A rating of less than 4.6 on Uber, for example, can result in disciplinary action. <br><br> Another set of platform strategies aim to equip users with information about what to expect from a transacting partner on the site—how reliable and trustworthy she can be expected to be, and how she can be expected to behave—based on indicators derived from past behavior. These indicators can confer a sense of expertise, reputation, or trustworthiness that may increase counterparties’ trust in the exchange—perhaps mitigating biases based on countervailing signals—and often take the form of badges or other graphic elements on users’ profiles.</p><br>");
			  } else {
			    d3.select("#photos").append("text")
			    .html("<p>Thanks for your rating! Unfortunately ratings of less than 4.6 on Uber can result in disciplinary action against the driver. Furthermore, the act of evaluation can act as a conduit for bias, meaning that underrepresented groups could have a lower rating than what you gave. <br><br> Another set of platform strategies aim to equip users with information about what to expect from a transacting partner on the site—how reliable and trustworthy she can be expected to be, and how she can be expected to behave—based on indicators derived from past behavior. These indicators can confer a sense of expertise, reputation, or trustworthiness that may increase counterparties’ trust in the exchange—perhaps mitigating biases based on countervailing signals—and often take the form of badges or other graphic elements on users’ profiles.</p><br>");
			  }
			  d3.select("#photos").append("button")
			  .attr("type", "button")
			  .text("Rate again")
			  .on("click", function(){
			    selected = 0;
			    stars = 0;
			    d3.selectAll(".star").style("fill", "grey");
			    d3.select("#photos").style("display", "none");
			    d3.select("#container7").style("height", "200px");
			    d3.select("#photos").selectAll("text").remove();
			    d3.select("#photos").select("button").remove();
			  });
			}
		});
		</script>
	</div> <!--END page6-->

	<div id="page7" class="slide" style="display: none">
		<h1> Reporting & Sanctioning </h1>
		<h2> Reporting Bias: A <i>Choose Your Own Adventure</i> Game </h2>
		<p>Reporting or flagging tools can be a powerful weapon against overt discrimination. But many platforms don't include this option by default. This game walks you through the process of reporting bias.</p>

<svg id="rs" width="960" height="500"></svg>

		<script>
		var rs = d3.select("#rs");

		function next(here, next){
			d3.select(here).attr("display", "none");
			d3.select(next).attr("display", "inline");
		}

		//START SET
		var s0 = rs.append("g").attr("id", "s0");
		s0.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});
		s0.append("rect")
			.attrs({height: 60, width: 320, x: 320, y: 200, fill: "#EACE41"})
			.on("click", function(){ next("#s0", "#s1"); });
		s0.append("text")
			.attrs({x: 470, y: 230 })
			.attr("text-anchor", "middle")
			.text("Click here to start.")
			.on("click", function(){ next("#s0", "#s1"); });


		//STEP 1: YOU SEE BIAS, WHAT DO YOU DO??
		var s1 = rs.append("g").attr("id", "s1").attr("display", "none");
		s1.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s1.append("image")
			.attr("xlink:href", "cya/bad.jpeg")
			.attrs({x: 40, y: 100})
			.attr("transform", "scale(1.5)");

		var text1 = ["You log into your favorite sharing economy site.", "You see a user treating another user poorly because of their race.", "What do you do?"];
		for(var i=0; i<text1.length; i++){
			s1.append("text")
				.attrs({ x: 50, y: 50+ (35*i), fill: "white"})
				.text(text1[i]);
			}
		s1.append("rect")
			.on("click", function(){ next("#s1", "#e1"); })
			.attrs({x:600, y:150, height: 60, width: 320, fill: "#EACE41"});
		s1.append("text")
			.on("click", function(){ next("#s1", "#e1"); })
			.attrs({x:620, y:180 })
			.text("Do Nothing.")

		s1.append("rect")
			.on("click", function(){ next("#s1", "#s2"); })
			.attrs({x:600, y: 250, height: 60, width: 320, fill:"#EACE41"});
		s1.append("text")
			.on("click", function(){ next("#s1", "#s2"); })
			.attrs({x:620, y: 280 })
			.text("Report the behavior!");


		//STEP 1, YOU HAVE CHOSEN NOT TO REPORT, YOU LOSE
		var e1 = rs.append("g").attr("id", "e1").attr("display", "none");
		e1.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});
		var text1_2 = ["You let someone get away with discrimination!", "Sorry, you lose the game.", "Make better choices next time!"];

		e1.append("image")
			.attr("xlink:href", "cya/try.jpg")
			.attrs({x: 70, y: 250})
			.attr("transform", "scale(0.6)");

		for(var i=0; i<text1_2.length; i++){
			e1.append("text")
				.attrs({ x: 50, y: 50+ (35*i), fill: "white"})
				.text(text1_2[i]);
			}
		e1.append("rect")
			.attrs({height: 60, width: 320, x: 350, y: 200, fill: "#EACE41"})
			.on("click", function(){ next("#e1", "#s0"); });
		e1.append("text")
			.attrs({x: 370, y: 230 })
			.text("Restart the game.")
			.on("click", function(){ next("#e1", "#s0"); });


		//STEP 2, YOU CHOOSE TO REPORT, WHAT HAPPENS?
		var s2 = rs.append("g").attr("id", "s2").attr("display", "none");
		s2.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s2.append("image")
			.attr("xlink:href", "cya/youplatform.jpg")
			.attrs({x: 40, y: 100})
			.attr("transform", "scale(0.8)");

		s2.append("text")
			.attrs({x: 40, y:40, fill: "white"})
			.text("You chose to click the report button.")

		var text2 = ["Oh, no!", "There's no option to report that behavior.", "What do you do?"];
		for(var i=0; i<text2.length; i++){
			s2.append("text")
				.attrs({ x: 350, y: 90+ (35*i), fill: "white"})
				.text(text2[i]);
			}
		s2.append("rect")
			.on("click", function(){ next("#s2", "#e1"); })
			.attrs({x:350, y:200, height: 60, width: 500, fill: "#EACE41"});
		s2.append("text")
			.on("click", function(){ next("#s2", "#e1"); })
			.attrs({x:370, y:230 })
			.attr("alignment-baseline", "middle")
			.text("Don't report anything.");

		s2.append("rect")
			.on("click", function(){ next("#s2", "#s3_2"); })
			.attrs({x:350, y: 300, height: 60, width: 500, fill:"#EACE41"});
		s2.append("text")
			.on("click", function(){ next("#s2", "#s3_2"); })
			.attrs({x:370, y: 330 })
			.attr("alignment-baseline", "middle")
			.text("Report them for something else.");

		s2.append("rect")
			.on("click", function(){ next("#s2", "#s3_1"); })
			.attrs({x:350, y: 400, height: 60, width: 500, fill:"#EACE41"});
		s2.append("text")
			.on("click", function(){ next("#s2", "#s3_1"); })
			.attrs({x:370, y: 430 })
			.attr("alignment-baseline", "middle")
			.text("Contact the company to complain.");


		//STEP 3_1, YOU HAVE CHOSEN TO COMPLAIN TO THE COMPANY
		var s3_1 = rs.append("g").attr("id", "s3_1").attr("display", "none");
		s3_1.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s3_1.append("image")
			.attr("xlink:href", "cya/ban.jpg")
			.attrs({x: 40, y: 200});

		var text3_1 = ["Great job!", "The biased user has been banned from the platform.", "What do you do next?"];
		for(var i=0; i<text3_1.length; i++){
			s3_1.append("text")
				.attrs({ x: 40, y: 50+ (35*i), fill: "white"})
				.text(text3_1[i]);
			}
		s3_1.append("rect")
			.on("click", function(){ next("#s3_1", "#s4_2"); })
			.attrs({x:520, y:200, height: 60, width: 360, fill: "#EACE41"});
		s3_1.append("text")
			.on("click", function(){ next("#s3_1", "#s4_2"); })
			.attrs({x:540, y:230 })
			.attr("alignment-baseline", "middle")
			.text("Do nothing more.")

		s3_1.append("rect")
			.on("click", function(){ next("#s3_1", "#s4_1"); })
			.attrs({x: 520, y: 300, height: 60, width:360, fill:"#EACE41"});
		s3_1.append("text")
			.on("click", function(){ next("#s3_1", "#s4_1"); })
			.attrs({ x:540, y: 330 })
			.attr("alignment-baseline", "middle")
			.text("Ask for better reporting.");


		//STEP 3_2, YOU HAVE CHOSEN TO REPORT A DIFFERENT BEHAVIOR
		var s3_2 = rs.append("g").attr("id", "s3_2").attr("display", "none");
		s3_2.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s3_2.append("image")
			.attr("xlink:href", "cya/tos.jpg")
			.attrs({x: 70, y: 350})
			.attr("transform", "scale(0.45)");

		var text3_2 = ["You reported someone for something they didn't actually do!", "This is a violation of the platform's terms of service.", "You have been removed from the platform for bad behavior."];
		for(var i=0; i<text3_2.length; i++){
			s3_2.append("text")
				.attrs({ x: 40, y: 40+ (35*i), fill: "white" })
				.text(text3_2[i]);
			}
		s3_2.append("rect")
			.on("click", function(){ next("#s3_2", "#s0"); })
			.attrs({x:500, y:200, height: 60, width: 320, fill: "#EACE41"});
		s3_2.append("text")
			.on("click", function(){ next("#s3_2", "#s0"); })
			.attrs({ x:520, y:230 })
			.attr("alignment-baseline", "middle")
			.text("Restart the game.");


		//STEP 4_1, YOU HAVE CHOSEN TO COMPLAIN MORE
		var s4_1 = rs.append("g").attr("id", "s4_1").attr("display", "none");
		s4_1.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s4_1.append("image")
			.attr("xlink:href", "cya/congrats.jpg")
			.attrs({x: 50, y: 240})
			.attr("transform", "scale(0.7)");

		var text4_1 = ["The company has added the option to report bias!", "You've made the experience better for everyone.", "You have won the game! Great job!"];
		for(var i=0; i<text4_1.length; i++){
			s4_1.append("text")
				.attrs({ x: 40, y: 50+ (35*i), fill: "white" })
				.text(text4_1[i]);
			}
		s4_1.append("rect")
			.on("click", function(){ next("#s4_1", "#s0"); })
			.attrs({x: 500, y: 250, height: 60, width: 320, fill: "#EACE41"});
		s4_1.append("text")
			.on("click", function(){ next("#s4_1", "#s0"); })
			.attrs({ x:520, y: 280 })
			.attr("alignment-baseline", "middle")
			.text("Play Again!");


		//STEP 4_2 YOU HAVE CHOSEN TO DO NOTHING MORE
		var s4_2 = rs.append("g").attr("id", "s4_2").attr("display", "none");
		s4_2.append("rect")
			.attrs({width: 960, height: 500, fill: "#70A9A1"});

		s4_2.append("image")
			.attr("xlink:href", "cya/try.jpg")
			.attrs({x: 50, y: 170})
			.attr("transform", "scale(0.7)");

		var text4_2 = ["You stopped one biased person, but the problem could recur.", "Try advocating for structural change next time."];
		for(var i=0; i<text4_2.length; i++){
			s4_2.append("text")
				.attrs({ x: 40, y: 50+ (35*i), fill: "white" })
				.text(text4_2[i]);
			}
		s4_2.append("rect")
			.on("click", function(){ next("#s4_2", "#s0"); })
			.attrs({x: 500, y: 250, height: 60, width: 320, fill: "#EACE41"});
		s4_2.append("text")
			.on("click", function(){ next("#s4_2", "#s0"); })
			.attrs({ x:520, y:280 })
			.attr("alignment-baseline", "middle")
			.text("Restart the game.");


		</script>
</div> <!--END page7-->
<div id="page8" class="slide" style="display: none">
	<h1> Measurement & Detection </h1>
	<h2> The Effect of Population Size on Relative Ratings</h2>
	<p>People are known to rate others from their own subgroups better than they do people from other groups. Try adjusting the number of people in the blue group and red group to see how the overall ratings for each group changes. </p>
	<p>Blue Raters: 10<input id="blueSlider" type="range" min="10" max="200" value="50" oninput="updateNums(value, redSlider.value)">200
	&nbsp;&nbsp;&nbsp;Red Raters:  10<input id="redSlider" type="range" min="10" max="200" value="50" oninput="updateNums(blueSlider.value, value)">200</p>
	<svg id = "md" width="960" height="500"></svg>
	<script>
	var md = d3.select("#md");


	md.append("text").attrs({x: 20, y: 150}).text("Ratings of Blue");
	md.append("text").attrs({x: 20, y: 300}).text("Ratings of Red");
	md.append("text").attrs({id: "bluenum", x: 100, y: 30});
	md.append("text").attrs({id: "rednum", x: 100, y: 60});

	var xScale = d3.scaleLinear().range([150, 750]);
	var curveXScale = d3.scaleLinear().range([150, 750]);
	var yScale = d3.scaleLinear();
	var min = 0;
	var max = 0;

	function updateNums(blue, red){

		d3.selectAll(".md").remove();

		red = Number(red);
		blue = Number(blue);
		d3.select("#rednum").text(red + " Red Raters");
		d3.select("#bluenum").text(blue + " Blue Raters");

		//n = number of raters (points), mu = mean, sigma = SD, y = point y location, id = point/set id, c = point color
		var blueOwn = make(blue, 4, 1, 150, "bb", "#304FFD");//own dist
		var redBlue = make(red, 2.5, 1.5, 150, "rb", "#F8333C");//other
		var blueRed = make(blue, 2.5, 1.5, 300, "br", "#304FFD");//other
		var redOwn = make(red, 4, 1, 300, "rr", "#F8333C");//own

		var rOsum = d3.sum(redOwn, function(d){ return d.q; });
		var bRsum = d3.sum(blueRed, function(d){ return d.q; });
		var bOsum = d3.sum(blueOwn, function(d){ return d.q; });
		var rBsum = d3.sum(redBlue, function(d){ return d.q; });

		var redMean = (rOsum/(red+blue)) + (bRsum/(red+blue));
		var blueMean = (bOsum/(red+blue)) + (rBsum/(blue+red));

		md.append("text").attrs({class: "md", x: 760, y: 150, fill:"black"})
			.text("Avg rating of Blue: " + Math.round(blueMean * 100)/100);
		md.append("text").attrs({class: "md", x: 760, y: 300, fill:"black"})
			.text("Avg rating of Red: " + Math.round(redMean * 100)/100);
	}
	//code for making curves adapted from:
	//http://bl.ocks.org/phil-pedruco/88cb8a51cdce45f13c7e
	function make(n, mu, sigma, y, id, c){
		var data = [];
		var dist = d3.randomNormal(mu, sigma);

		for (var i = 0; i < n; i++) {
				q = dist(); // calc random draw from normal dist
				if(q>max){ max=q; };
				if(q<min){ min=q; };
				p = gaussian(q, mu, sigma) // calc prob of rand draw
				point = { "q": q, "p": p, "y": y}
				data.push(point)
		};

		data.sort(function(x, y) {
				return x.q - y.q;
		});

		xScale.domain([min, max]);
		curveXScale.domain(d3.extent(data, function(d){ return d.q; }));
		yScale.domain(d3.extent(data, function(d) { return d.p; })).range([y, y-120]);

		var line = d3.line()
		  .x(function(d) { return xScale(d.q); })
		  .y(function(d) { return yScale(d.p); });

		md.append("path")
		    .datum(data)
				.attrs({id: "curvepath", class: "md", stroke: c, d: line});

		md.selectAll("circle#" + id).data(data).enter().append("circle")
			.attr("cx", function(d){ return xScale(d.q); })
			.attr("cy", function(d){ return d.y; })
			.attrs({id: id, class: "md", r: 5, fill: c, opacity: 0.2});

		return data;
	}

	// https://github.com/jasondavies/science.js/
	function gaussian(x, mu, sigma) {
		var gaussianConstant = 1 / Math.sqrt(2 * Math.PI);
	  x = (x - mu) / sigma;
	  return gaussianConstant * Math.exp(-.5 * x * x) / sigma;
	};

	updateNums(50, 50);

	xAxis = d3.axisBottom(xScale);
	md.append("g").call(xAxis).attr("transform", "translate(0,320)");

	</script>
	<p>As you can see, an increase in the number of blue raters results in higher ratings for blue users, and vice versa. This is just one example of how bias on platforms can be measured and detected. If we can understand how ratings are distributed for people of different types, we can better construct algorithms that detect and eliminate such bias.</p>
</div> <!--END page8-->

</div> <!--END page-wrap-->

<!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script> -->
</body>
<footer>
	<p> Developed by Jevan Hutson, Jessie Taft, Olivia Wherry, & Tyler Alicea </p>
</footer>
</html>
